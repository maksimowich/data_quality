------------------- статистика по таблицам ------------------------------
create table test.dq_table_statistics (
    table_name                  string,
    column_name                 string,
    column_id                   bigint,
    data_type                   string,
    comment                     string,
    start_of_calculation_period date,
    end_of_calculation_period   date,
    interval_type               string,
    rows_amount_cnt             int,
    amount_completed_cnt        int,
    nulls_amount_cnt            int,
    distinct_amount_cnt         int,
    minimum_value_info          decimal(19,2),
    maximum_value_info          decimal(19,2),
    median_value_info           decimal(19,2),
    average_value_info          decimal(19,2),
    sum_attributes_nval         decimal(19,2),
    dublicate_cnt               int,
    report_dttm                 timestamp
) stored as parquet;


--------------- таблица с информацией как и что проверять -----------------------
create table test.dq_setup_table (
    TABLE_NAME                      string,
    TABLE_DATE_FIELD                string,
    NEXT_CHECK_DT                   date,
    INTERVAL_TYPE                   string
) stored as parquet;


create table test.dq_deviations_setup as (
    table_name string,
    column_name string,
    rows_amount_cnt decimal(19,2),
    amount_completed_cnt decimal(19,2),
    nulls_amount_cnt decimal(19,2),
    distinct_amount_cnt decimal(19,2),
    minimum_value_info decimal(19,2),
    maximum_value_info decimal(19,2),
    median_value_info decimal(19,2),
    average_value_info decimal(19,2),
    sum_attributes_nval decimal(19,2),
    period_to_dt date
) stored as parquet;


create table upd.airflow.metrics (
    table_name                          string,
    column_name                         string,
    comment                             string,
    data_type                           string,
    column_id                           int,
    comparison_dt                       date,
    report_dttm                         timestamp,
    rows_amount_cnt                     int,
    delta_rows_amount_cnt               decimal(19,2),
    amount_completed_cnt                int,
    delta_amount_completed_cnt          decimal(19,2),
    nulls_amount_cnt                    int,
    delta_nulls_amount_cnt              decimal(19,2),
    distinct_amount_cnt                 int,
    delta_distinct_amount_cnt           decimal(19,2),
    minimum_value_info                  decimal(19,2),
    delta_minimum_value_info            decimal(19,2),
    maximum_value_info                  decimal(19,2),
    delta_maximum_value_info            decimal(19,2),
    median_value_info                   decimal(19,2),
    delta_median_value_info             decimal(19,2),
    average_value_info                  decimal(19,2),
    delta_average_value_info            decimal(19,2),
    sum_attributes_nval                 decimal(19,2),
    delta_sum_attributes_nval           decimal(19,2),
    dublicate_cnt                       int,
    deviation_flg                       int,
    deviation_desc                      string,
) stored as parquet;